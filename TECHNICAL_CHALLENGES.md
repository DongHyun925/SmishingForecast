# 🔮 Smishing Forecast - 기술적 제약 및 해결 전략 보고서

## 📌 목차
1. [고맥락(High-Context) 스미싱 탐지의 어려움](#1-고맥락high-context-스미싱-탐지의-어려움)
2. [소량의 데이터로 즉각적인 자가 진화 구현](#2-소량의-데이터로-즉각적인-자가-진화-구현)
3. [정상/스미싱 데이터 불균형 문제](#3-정상스미싱-데이터-불균형-문제)
4. [Streamlit의 상태 비저장성(Stateless)과 DB 연동](#4-streamlit의-상태-비저장성stateless과-db-연동)

---

## 1. 고맥락(High-Context) 스미싱 탐지의 어려움

### 🛑 제약 사항 (Challenge)
기존의 키워드 기반 필터링이나 단순 머신러닝 모델은 **"엄마 나 폰 고장났어"**와 같이 악성 키워드(대출, 광고, URL)가 전혀 없는 **일상 대화형 스미싱**을 탐지하지 못했습니다. 특히 한국어의 특성상 발화의 의도가 문맥(Context) 속에 숨겨져 있어, 단순 단어 매칭으로는 '정상적인 가족 간 대화'와 '지인 사칭 스미싱'을 구분하기 매우 어려웠습니다.

### ✅ 해결 전략 (Solution)
**LLM 기반 의도 분석(Intent Analysis) 도입**
- **Detector + Analyzer 이원화**: 1차적으로 `RoBERTa` 모델이 스미싱 확률을 계산하고, 이와 병행하여 `GPT-4`가 메시지의 **잠재적 의도(Intent)**를 심층 분석하도록 설계했습니다.
- **심리 기제 분석**: 메시지 내에 포함된 '긴급성(Urgency)', '권위(Authority)', '이득 유혹(Greed)' 등의 심리적 트리거를 분석하여, 겉으로는 평범해 보이지만 실제로는 피해자의 행동을 유도하는 패턴을 식별했습니다.
- **결과**: 키워드가 없는 '스텔스 모드' 공격에 대해서도 의도 분석을 통해 위험성을 경고할 수 있게 되었습니다.

---

## 2. 소량의 데이터로 즉각적인 자가 진화 구현

### 🛑 제약 사항 (Challenge)
일반적인 딥러닝 모델(BERT, RoBERTa 등)은 새로운 패턴을 학습하기 위해 수천, 수만 건의 데이터와 긴 학습 시간이 필요합니다. 하지만 스미싱 공격은 매우 빠르게 변화하므로, **단 1건의 새로운 공격 사례**만 발견되더라도 즉시 방어 체계에 반영해야 하는 **실시간성(Real-time)** 요구사항이 있었습니다.

### ✅ 해결 전략 (Solution)
**Few-Shot Learning & Data Augmentation (소수샷 학습 및 데이터 증강)**
- **데이터 증강**: `Trainer` 모듈에서 탐지에 실패한 1건의 스미싱 데이터를 `GPT-4`를 활용하여 **유사한 변형 데이터 10개**로 실시간 증강했습니다. (예: 어조 변경, 단어 교체 등)
- **전이 학습(Fine-tuning)**: 사전 학습된(Pre-trained) `RoBERTa` 모델의 마지막 레이어만 빠르게 재학습(Fine-tuning)시키는 방식을 적용하여, 전체 모델을 처음부터 학습하는 것보다 **수십 배 빠른 속도**로 새로운 패턴을 반영했습니다.
- **결과**: 단 1번의 '자가 진화' 버튼 클릭만으로도 탐지 점수를 0.01% -> 99.9%로 극적으로 향상시킬 수 있었습니다.

---

## 3. 정상/스미싱 데이터 불균형 문제

### 🛑 제약 사항 (Challenge)
현실 세계에서는 정상 문자가 스미싱 문자보다 압도적으로 많습니다. 학습 데이터 수집 과정에서도 **다양하고 정교한 스미싱 데이터**를 확보하는 것이 매우 어려웠습니다. 데이터가 불균형하면 모델은 무조건 "정상"이라고 예측하려는 편향(Bias)을 가지게 됩니다.

### ✅ 해결 전략 (Solution)
**Red Team(공격자) 시뮬레이션 활용**
- **적대적 생성(Adversarial Generation)**: 실제 해커가 수행하듯, `Planner`와 `Generator` 에이전트가 최신 뉴스를 기반으로 **가상의 고품질 스미싱 데이터**를 스스로 생성했습니다.
- **Hard Negative Mining**: 모델이 '정상'으로 오판하기 쉬운 **교묘한(Ambiguous) 공격 패턴**을 집중적으로 생성하고 학습시켜, 모델의 변별력을 높였습니다.
- **결과**: 실제 스미싱 데이터를 수집하기 어려운 초기 단계에서도, 1,000건 이상의 고품질(High-Quality) 적대적 데이터를 확보하여 모델 성능을 안정화했습니다.

---

## 4. Streamlit의 상태 비저장성(Stateless)과 DB 연동

### 🛑 제약 사항 (Challenge)
`Streamlit` 프레임워크는 사용자가 버튼을 누를 때마다 **스크립트 전체가 처음부터 다시 실행(Rerun)**되는 구조를 가지고 있습니다. 이로 인해 AI 모델을 매번 새로 로딩하거나, 데이터베이스 연결이 끊기는 비효율성이 발생했습니다. 또한, 공격 시나리오 생성 -> 탐지 -> 진화로 이어지는 **단계별 상태(State)**를 유지하는 것이 까다로웠습니다.

### ✅ 해결 전략 (Solution)
**Session State 관리 및 리소스 캐싱**
- **`st.cache_resource`**: 무거운 AI 모델(`RoBERTa`, `Tokenizer`)과 DB 연결 객체는 캐싱하여, 앱이 리로드되더라도 **한 번만 로딩**되도록 최적화했습니다.
- **Session State Pipeline**: `current_attack`, `generated`, `evolution_finished` 등 단계별 플래그를 `st.session_state`에 저장하여, 앱이 리로드되어도 **현재 작업 흐름이 끊기지 않도록** 상태를 관리했습니다.
- **결과**: 매끄러운 사용자 경험(UX)을 제공하면서도, 불필요한 모델 로딩 시간을 제거하여 응답 속도를 개선했습니다.
